From 1892aeb9c13841335a4ac383e8a787a3c2728c45 Mon Sep 17 00:00:00 2001
From: Michael Biebl <biebl@debian.org>
Date: Fri, 9 Dec 2011 00:31:21 +0100
Subject: [PATCH] Revert "Default to AdminIdentities=unix-group:wheel for
 local authority"

This reverts commit 763faf434b445c20ae9529100d3ef5290976d0c9.

On Red Hat derivatives, every member of group 'wheel' is necessarily
privileged. On Debian derivatives, there is no wheel group, and gid 0
(root) is not used in this way. Change the default rule to consider
uid 0 to be privileged, instead.

On Red Hat derivatives, 50-default.rules is not preserved by upgrades;
on dpkg-based systems, it is a proper conffile and may be edited
(at the sysadmin's own risk), so the comment about not editing it is
misleading.

[smcv: added longer explanation of why we make these changes]
---
 docs/man/pklocalauthority.xml            |    4 ++--
 src/polkitbackend/50-localauthority.conf |    2 +-
 2 files changed, 3 insertions(+), 3 deletions(-)

Index: policykit-1/src/polkitbackend/50-default.rules
===================================================================
--- policykit-1.orig/src/polkitbackend/50-default.rules	2013-01-02 22:23:30.493517748 +0100
+++ policykit-1/src/polkitbackend/50-default.rules	2013-01-02 22:23:49.205709658 +0100
@@ -1,12 +1,10 @@
 /* -*- mode: js; js-indent-level: 4; indent-tabs-mode: nil -*- */
 
-// DO NOT EDIT THIS FILE, it will be overwritten on update
-//
 // Default rules for polkit
 //
 // See the polkit(8) man page for more information
 // about configuring polkit.
 
 polkit.addAdminRule(function(action, subject) {
-    return ["unix-group:wheel"];
+    return ["unix-user:0"];
 });
